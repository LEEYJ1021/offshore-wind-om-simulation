# Offshore Wind O&M Simulation
## Hierarchical Maintenance Decision Process (HMDP) + LP Scheduling with Empirical Weather Data

[![License: MIT](https://img.shields.io/badge/License-MIT-blue.svg)](LICENSE)
[![R](https://img.shields.io/badge/R-4.3%2B-276DC3?logo=r)](https://www.r-project.org/)
[![Python](https://img.shields.io/badge/Python-3.10%2B-3776AB?logo=python)](https://www.python.org/)

---

## Overview

This repository contains the full analysis pipeline for an offshore wind turbine operations & maintenance (O&M) simulation study conducted for the **Ulsan Offshore Wind Farm** (South Korea), covering the period **2023–2025** across **50 turbines** (DTU 10MW reference class).

The study integrates:
- **Empirical hourly/daily/weekly marine weather data** from Ulsan offshore station
- **HMDP (Hierarchical Maintenance Decision Process)** with Condition-Based Maintenance (CBM)
- **LP-based maintenance scheduling** with weather-routing and multi-port dispatch
- **Weibull failure modelling** with 18 component types and granular ETA (output derating) tables
- **Imperfect repair feedback loop**: post-repair effective-age update → Weibull hazard recalibration → dynamic LP prioritisation

---

## Repository Structure

```
offshore-wind-om-simulation/
│
├── README.md
├── LICENSE
│
├── data/
│   ├── raw/
│   │   ├── weather_hourly_raw.csv   ← Raw hourly weather (place input here)
│   │   └── weekly_cost_baseline.csv ← Weekly O&M cost baseline (place input here)
│   ├── processed/                   ← Auto-generated by R preprocessing script
│   │   ├── ulsan_hourly_weather_simple.csv
│   │   ├── ulsan_hourly_weather_detailed.csv
│   │   ├── ulsan_daily_weather_simple.csv
│   │   ├── ulsan_daily_weather_detailed.csv
│   │   ├── ulsan_weekly_weather_simple.csv
│   │   └── ulsan_weekly_weather_detailed.csv
│   └── outputs/                     ← Statistical tables from R
│       ├── Table1_Seasonal_Statistics.csv
│       ├── Table1b_Daily_Seasonal_Statistics.csv
│       ├── Table1c_Hourly_Seasonal_Statistics.csv
│       ├── Table1d_Hourly_TimeOfDay_Statistics.csv
│       ├── Table1e_Hourly_ByHour_Statistics.csv
│       ├── Table2_Weather_Transition_Matrix.csv
│       ├── Table3_Accessibility_Summary.csv
│       └── Table3b_Daily_Accessibility_Summary.csv
│
├── scripts/
│   ├── 01_weather_preprocessing.R   ← R: hourly → daily → weekly aggregation + figures
│   └── 02_om_simulation.py          ← Python: HMDP-LP O&M simulation
│
└── results/
    ├── figures_R/                     ← PNG figures (R)
    │   ├── Fig01_Weather_Overview.png
    │   ├── Fig02_Seasonal_Accessibility.png
    │   ├── Fig03_ComponentCriticality_Weibull.png
    │   ├── Fig04_Strategy_Comparison.png
    │   ├── Fig05_Availability_Decomposition.png
    │   ├── Fig06_HMDP_LP_Integration.png
    │   ├── Fig07_CBM_vs_FixedPM.png
    │   ├── Fig08_Baseline_Comparison.png
    │   ├── Fig09_Scenario_Sensitivity.png
    │   ├── Fig10_Carbon_Pareto.png
    │   ├── Fig11_ETA_Derating_Analysis.png
    │   ├── Fig12_Feedback_Loop_Analysis.png
    │   └── Fig13_Empirical_Validation.png
    ├── figures_PY/                     ← NG figures (Python)
    │   ├── Fig01_Weather_Overview.png
    │   ├── Fig02_Seasonal_Accessibility.png
    │   ├── Fig03_ComponentCriticality_Weibull.png
    │   ├── Fig04_Strategy_Comparison.png
    │   ├── Fig05_Availability_Decomposition.png
    │   ├── Fig06_HMDP_LP_Integration.png
    │   ├── Fig07_CBM_vs_FixedPM.png
    │   ├── Fig08_Baseline_Comparison.png
    │   ├── Fig09_Scenario_Sensitivity.png
    │   ├── Fig10_Carbon_Pareto.png
    │   ├── Fig11_ETA_Derating_Analysis.png
    │   ├── Fig12_Feedback_Loop_Analysis.png
    │   └── Fig13_Empirical_Validation.png
    ├── tables/                      ← Summary tables from Python simulation
    │   ├── simulation_kpis.csv
    │   ├── bootstrap_ci_kpis.csv
    │   ├── delay_days_kpi.csv
    │   ├── cost_breakdown.csv
    │   └── stat_tests.csv
    └── csv/                         ← Full daily/event logs from simulation
        ├── hmdp_daily_results.csv
        ├── repair_feedback_log.csv
        └── completed_events.csv
```

---

## Data

### Input Files (place in `data/raw/`)

| File | Description | Rows | Frequency |
|------|-------------|------|-----------|
| `weather_hourly_raw.csv` | Ulsan offshore station — wind, wave, temperature, pressure | ~25,190 | Hourly |
| `weekly_cost_baseline.csv` | Weekly O&M cost baseline (LP scheduling reference) | 52 | Weekly |

> **Note:** The raw data files are not included in this repository due to data-sharing restrictions. Contact the corresponding author for access. The simulation will fall back to a Markov-chain synthetic weather generator if no input file is found.

#### `weather_hourly_raw.csv` — Column Schema

| Column | Unit | Description |
|--------|------|-------------|
| `지점` / `station` | ID | Weather station identifier |
| `일시` / `datetime` | YYYY-MM-DD HH:MM | Timestamp (Asia/Seoul) |
| `풍속(m/s)` | m/s | Mean wind speed |
| `풍향(deg)` | ° | Wind direction |
| `GUST풍속(m/s)` | m/s | Maximum gust speed |
| `현지기압(hPa)` | hPa | Atmospheric pressure |
| `습도(%)` | % | Humidity |
| `기온(°C)` | °C | Air temperature |
| `수온(°C)` | °C | Sea surface temperature |
| `최대파고(m)` | m | Maximum wave height |
| `유의파고(m)` | m | Significant wave height (Hs) |
| `평균파고(m)` | m | Mean wave height |
| `파주기(sec)` | s | Wave period |
| `파향(deg)` | ° | Wave direction |

#### `weekly_cost_baseline.csv` — Column Schema

| Column | Type | Description |
|--------|------|-------------|
| `week_num` | int | ISO week index (1–52) |
| `week_label` | string | Week start–end date label |
| `ShipCost` | KRW | Vessel operating cost |
| `PortCost` | KRW | Port usage cost |
| `LaborCost` | KRW | Labour cost |
| `DowntimeCost` | KRW | Idle/non-operational cost |
| `PartsCost` | KRW | Maintenance parts cost |
| `TotalCost` | KRW | Total weekly O&M cost |

### Processed / Output Files (auto-generated)

All processed datasets and result tables are generated automatically by running the scripts. See the structure above for expected output locations.

---

## Scripts

### `scripts/01_weather_preprocessing.R`

**Purpose:** Processes raw hourly marine weather data into hourly, daily, and weekly aggregated datasets, computes accessibility indicators, and generates publication-quality figures (Figs 1–10).

**Key steps:**
1. Load and rename raw columns
2. Outlier removal (5×MAD rule) + linear interpolation for gaps
3. Compute `ctv_accessible` (Hs ≤ 1.5 m AND wind ≤ 10 m/s) and `sov_accessible` (Hs ≤ 2.5 m)
4. Aggregate to daily (mean/max/percentile statistics) and weekly (ISO week)
5. Compute seasonal statistics, Markov transition matrix, and accessibility summaries
6. Save 6 processed datasets + 8 statistical tables + 10 figures

**Run:**
```r
# From repo root or RStudio
source("scripts/01_weather_preprocessing.R")
```

**Dependencies:**
```r
install.packages(c("tidyverse", "lubridate", "data.table", "ggplot2",
                   "patchwork", "scales", "viridis", "gridExtra", "zoo"))
```

---

### `scripts/02_om_simulation.py`

**Purpose:** Runs the full HMDP + LP O&M simulation for 4 maintenance strategies over 3 years (2023–2025), computes KPIs, statistical tests, and generates Figs 1–13 + all CSV outputs.

**Strategies simulated:**

| ID | Label | Vessel | Weather | PM Mode |
|----|-------|--------|---------|---------|
| S1 | Fixed PM / No Weather | CTV only | ✗ | Fixed schedule |
| S2 | Fixed PM / Weather-Aware | CTV + SOV | ✓ | Fixed schedule |
| S3 | Multi-Port / Weather | CTV + SOV | ✓ | Fixed schedule |
| S4 | **HMDP: CBM + Hierarchical LP** | CTV + SOV | ✓ | **CBM (Weibull)** |

**Key modelling features:**
- **18 component types** with empirical failure rate distributions (Minor / Major Repair / Replacement)
- **Weibull hazard model** (β = 2.5, η = 80 weeks) driving CBM trigger thresholds
- **Granular ETA derating table** (54 component × severity cells): partial production loss
- **Imperfect repair model**: restoration factor RF ∈ {0.20, 0.55, 0.90} by severity
- **Explicit feedback loop**: `apply_repair()` → effective age update → Weibull hazard recalculation → dynamic LP priority
- **Bootstrap 95% CI** for weekly cost KPIs
- **Mann-Whitney U + Welch t-test + Cohen's d** for pairwise comparisons

**Run:**
```bash
cd repo
python scripts/02_om_simulation.py
```

**Dependencies:**
```bash
pip install numpy pandas matplotlib scipy
```

**Weather data fallback:** If `data/raw/weather_hourly_raw.csv` (or `data/raw/ulsan_daily_weather_simple.csv`) is not found, the script automatically generates synthetic weather using a Markov chain calibrated to the Ulsan seasonal statistics from the empirical dataset.

---

## Key Results

| Strategy | 3Y Total Cost | AO (%) | AEP (%) | Critical Failures |
|----------|--------------|--------|---------|-----------------|
| S1: Fixed PM / No Weather | Baseline | ~82% | ~78% | Highest |
| S2: Fixed PM / Weather | −5% | ~85% | ~81% | High |
| S3: Multi-Port / Weather | −8% | ~87% | ~84% | Moderate |
| **S4: HMDP CBM** | **+12–18%** | **~93%** | **~91%** | **Lowest (−80%)** |

> HMDP shows statistically significant superiority on availability and failure reduction (p < 0.001, Cohen |d| > 0.8) despite higher O&M cost, due to elimination of unplanned critical failures and downtime.

---

## Figures

| Figure | Script | Description |
|--------|--------|-------------|
| Fig01–06 | R | Weather overview, seasonal distributions, accessibility, wind rose, heatmaps |
| Fig07–10 | R | Hourly wind/wave by time-of-day, CTV accessibility by hour/season |
| Fig01–04 | Python | Weather overview, seasonal accessibility, Weibull/ETA, strategy comparison |
| Fig05–10 | Python | Availability decomposition, HMDP-LP integration, CBM analysis, sensitivity |
| Fig11 | Python | ETA derating matrix (54-cell) + AEP impact |
| Fig12 | Python | Feedback loop: post-repair age update & hazard recalibration |
| Fig13 | Python | Empirical validation: delay-days, statistical tests, cost decomposition |

---

## Simulation Parameters

| Parameter | Value |
|-----------|-------|
| Turbines | 50 × DTU 10MW |
| Simulation period | 2023-01-01 – 2025-12-31 |
| Location | Ulsan offshore, South Korea |
| CTV operational limits | Wind ≤ 10 m/s, Hs ≤ 1.5 m |
| SOV operational limits | Hs ≤ 2.5 m |
| Electricity price | 155,500 KRW/MWh (incl. REC) |
| Weibull shape β | 2.5 |
| Weibull scale η | 80 weeks |
| CBM threshold (Critical) | R(t) < 88% |
| CBM threshold (Semi-Critical) | R(t) < 82% |
| CBM threshold (Non-Critical) | R(t) < 75% |
| Random seed | 42 |

---

## License

This project is licensed under the MIT License — see [LICENSE](LICENSE) for details.
